#######
# 4: Menus
###########
MenuStyle * MenuColorset 5, ActiveColorset 6, GreyedColorset 7, TitleColorset 8
MenuStyle * Hilight3DOff, HilightBack, HilightTitleBack, SeparatorsLong
MenuStyle * TrianglesSolid, TrianglesUseFore
MenuStyle * ItemFormat "%s%|%3.1i%5.3l%5l%5r%5.3>%|"
MenuStyle * Font "xft:Sans:Bold:size=8:antialias=True"

# Root Menu
#
# The root menu will PopUp with a click in the root
# window or using alt-f1 (or menu).
DestroyMenu MenuFvwmRoot
AddToMenu   MenuFvwmRoot "Fvwm" Title
+ "&Terminal%icons/terminal.png%"          Exec exec $[infostore.terminal]
+ "&File Manager%icons/file-manager.png%" Exec exec pcmanfm-qt 
Test (x $[infostore.runcmd]) + "R&un Command%icons/run_arrow.png%" Exec exec $[infostore.runcmd] $[infostore.runcmdopt]
+ "" Nop
PipeRead 'f=/usr/share/applications/brave-browser.desktop; [ -f "$f" ] && { name=$(grep "^Name=" "$f" | head -1 | cut -d= -f2); echo "+ \\"&$name%icons/brave.png%\\" Exec exec brave"; } || echo "+ \\"&Brave Browser%icons/brave.png%\\" Exec exec brave"'
PipeRead 'f=/usr/share/applications/code.desktop; [ -f "$f" ] && { name=$(grep "^Name=" "$f" | head -1 | cut -d= -f2); echo "+ \\"&$name%icons/vscode.png%\\" Exec exec code"; } || echo "+ \\"&Visual Studio Code%icons/vscode.png%\\" Exec exec code"'
PipeRead 'f=/usr/share/applications/org.keepassxc.KeePassXC.desktop; [ -f "$f" ] && { name=$(grep "^Name=" "$f" | head -1 | cut -d= -f2); echo "+ \\"&$name%icons/keepassxc.png%\\" Exec exec keepassxc"; } || echo "+ \\"&KeePassXC%icons/keepassxc.png%\\" Exec exec keepassxc"'
PipeRead 'f=/usr/share/applications/thunderbird.desktop; [ -f "$f" ] && { name=$(grep "^Name=" "$f" | head -1 | cut -d= -f2); echo "+ \\"&$name%icons/thunderbird.png%\\" Exec exec thunderbird"; } || echo "+ \\"&Thunderbird%icons/thunderbird.png%\\" Exec exec thunderbird"'
+ "" Nop
+ "&XDG Menu%icons/apps.png%"     Popup XDGMenu
+ "&Background%icons/wallpaper.png%"      Popup BGMenu
+ "&Help%icons/help.png%"         Popup MenuFvwmManPages
+ "" Nop
+ "&Refresh%icons/refresh.png%" Refresh
+ "&Restart%icons/restart.png%" Restart
+ "&Quit%icons/quit.png%"       Module FvwmScript FvwmScript-ConfirmQuit

# Generate XDGMenu
PipeRead "fvwm-menu-desktop -e"

# Generate Web Apps Menu (Brave PWAs)
DestroyFunc GenerateWebAppsMenu
AddToFunc GenerateWebAppsMenu
+ I DestroyMenu WebAppsMenu
+ I PipeRead 'echo "AddToMenu WebAppsMenu \\"Web Apps\\" Title"'
+ I PipeRead 'for desktop in ~/.local/share/applications/chrome-*.desktop; do \
    [ -f "$desktop" ] || continue; \
    name=$(grep "^Name=" "$desktop" | head -1 | cut -d= -f2); \
    icon=$(grep "^Icon=" "$desktop" | head -1 | cut -d= -f2); \
    [ -n "$icon" ] && icon_opt="%$icon%" || icon_opt=""; \
    echo "+ \\"$name$icon_opt\\" Exec exec gtk-launch $(basename "$desktop")"; \
done'
+ I PipeRead '[ -z "$(ls -A ~/.local/share/applications/chrome-*.desktop 2>/dev/null)" ] && echo "+ \\"No Web Apps Installed\\" Nop"'

# Initialize Web Apps Menu
GenerateWebAppsMenu

# ViewManPage Function for Help Menu
DestroyFunc ViewManPage
AddToFunc   ViewManPage
+ I Exec exec xterm -g 80x40 -n "Manual Page - $0" -T "Manual Page - $0" -e man "$0"

# Background Menu
#
# Backgrounds are located in ~/.fvwm/images/background/
# Menu icons are located in ~/.fvwm/images/bgicons/
DestroyMenu BGMenu
AddToMenu   BGMenu "Wallpapers" Title
+ "&Floral%bgicons/bg1.png%"  SetBG bg1.png
+ "&Circles%bgicons/bg2.png%" SetBG bg2.png
+ "&Space%bgicons/bg3.png%"   SetBG bg3.png

# Window Operations Menus
DestroyMenu MenuWindowOps
AddToMenu   MenuWindowOps
+ "&Move"         Move
+ "&Resize"       Resize
+ "&Iconify"      Iconify
+ "Ma&ximize"     Maximize
+ "&Shade"        WindowShade
+ "S&tick"        Stick
+ "" Nop
+ "&Close"        Close
+ "&More..."      Menu MenuWindowOpsLong This 0 0

DestroyMenu MenuWindowOpsLong
AddToMenu   MenuWindowOpsLong "Window Operations" Title
+ "&Move%icons/win/move.png%"           Move
+ "&Resize%icons/win/resize.png%"       Resize
+ "&Iconify%icons/win/iconify.png%"     Iconify
+ "Ma&ximize%icons/win/max.png%"        Maximize
+ "&Shade%icons/win/shade.png%"         WindowShade
+ "S&tick%icons/win/sticky.png%"        Stick
+ "Toggle &Title%icons/win/title.png%"  Pick (CirculateHit) ToggleTitle
+ "&Send To%icons/win/sendto.png%"      Popup MenuSendTo
+ "" Nop
+ "&Close%icons/win/close.png%"         Close
+ "&Destroy%icons/win/destroy.png%"     Destroy
+ "" Nop
+ "&Raise%icons/win/raise.png%"         Raise
+ "&Lower%icons/win/lower.png%"         Lower
+ "" Nop
+ "Stay on &Top%icons/win/top.png%"     Pick (CirculateHit) Layer 0 6
+ "Stay &Put%icons/win/stays.png%"      Pick (CirculateHit) Layer 0 4
+ "Stay on &Bottom%icons/win/bottom.png%" Pick (CirculateHit) Layer 0 2
+ "" Nop
+ "&Identify%icons/info.png%" Module FvwmIdent

DestroyMenu MenuIconOps
AddToMenu   MenuIconOps
+ "&Iconify%icons/win/iconify.png%"     Iconify
+ "Ma&ximize%icons/win/max.png%"        Maximize
+ "&Shade%icons/win/shade.png%"         WindowShade
+ "S&tick%icons/win/sticky.png%"        Stick
+ "Toggle &Title%icons/win/title.png%"  Pick (CirculateHit) ToggleTitle
+ "&Send To%icons/win/sendto.png%"      Popup MenuSendTo
+ "" Nop
+ "&Close%icons/win/close.png%"         Close
+ "&Destroy%icons/win/destroy.png%"     Destroy
+ "" Nop
+ "&Raise%icons/win/raise.png%"         Raise
+ "&Lower%icons/win/lower.png%"         Lower
+ "" Nop
+ "Stay on &Top%icons/win/top.png%"     Pick (CirculateHit) Layer 0 6
+ "Stay &Put%icons/win/stays.png%"      Pick (CirculateHit) Layer 0 4
+ "Stay on &Bottom%icons/win/bottom.png%" Pick (CirculateHit) Layer 0 2
+ "" Nop
+ "&Identify%icons/info.png%" Module FvwmIdent

DestroyMenu MenuSendTo
AddToMenu MenuSendTo
+ "&Current" MoveToCurrent
+ "&Page"    PopUp MenuSendToPage
+ "&Desk"    PopUp MenuSendToDesk

DestroyMenu MenuSendToDesk
AddToMenu   MenuSendToDesk
+ "Desk &0" MoveToDesk 0 0
+ "Desk &1" MoveToDesk 0 1
+ "Desk &2" MoveToDesk 0 2
+ "Desk &3" MoveToDesk 0 3

DestroyMenu MenuSendToPage
AddToMenu   MenuSendToPage
+ "Page (&0,0)" MoveToPage 0 0
+ "Page (0,&1)" MoveToPage 0 1
+ "Page (&1,0)" MoveToPage 1 0
+ "Page (1,&1)" MoveToPage 1 1


# Fvwm Man Pages (Help) Menu
DestroyMenu MenuFvwmManPages
AddToMenu   MenuFvwmManPages "Help" Title
+ "fvwm3"         ViewManPage fvwm3
+ "fvwm3commands" ViewManPage fvwm3commands
+ "fvwm3styles"   ViewManPage fvwm3styles
+ "fvwm3menus"    ViewManPage fvwm3menus
+ "fvwm3all"      ViewManPage fvwm3all
+ "" Nop
+ "FvwmAnimate"   ViewManPage Fvwm3Animate
+ "FvwmAuto"      ViewManPage Fvwm3Auto
+ "FvwmBacker"    ViewManPage Fvwm3Backer
+ "FvwmButtons"   ViewManPage Fvwm3Buttons
+ "FvwmCommand"   ViewManPage Fvwm3Command
Test (x $[FVWM_MODULEDIR]/FvwmConsole) + "FvwmConsole" ViewManPage Fvwm3Console
+ "FvwmEvent"     ViewManPage Fvwm3Event
+ "FvwmIconMan"   ViewManPage Fvwm3IconMan
+ "FvwmIdent"     ViewManPage Fvwm3Ident
+ "FvwmPager"     ViewManPage Fvwm3Pager
+ "FvwmPerl"      ViewManPage Fvwm3Perl
Test (x FvwmPrompt) + "FvwmPrompt" ViewManPage FvwmPrompt
+ "FvwmRearrange" ViewManPage Fvwm3Rearrange
+ "FvwmScript"    ViewManPage Fvwm3Script
+ "" Nop
+ "fvwm3-root"           ViewManPage fvwm3-root
+ "fvwm3-menu-desktop"   ViewManPage fvwm3-menu-desktop
+ "fvwm3-menu-directory" ViewManPage fvwm3-menu-directory
+ "fvwm3-menu-xlock"     ViewManPage fvwm3-menu-xlock